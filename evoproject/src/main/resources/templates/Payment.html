<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Payment</title>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://cdn.iamport.kr/js/iamport.payment-1.1.7.js"></script>
</head>
<body>
<h2>Payment</h2>
<form id="paymentForm">
    <input type="hidden" id="orderId" th:value="${order.id}" />
    <input type="hidden" id="orderName" th:value="${order.item}" />
    <input type="hidden" id="orderAmount" th:value="${order.price}" />
</form>
<button id="payButton">Pay Now</button>

<script>
    var IMP = window.IMP;
    IMP.init('imp77114780');

    $('#payButton').click(function () {
        var orderId = $('#orderId').val();
        var orderName = $('#orderName').val();
        var orderAmount = $('#orderAmount').val();

        console.log("Order ID: " + orderId);
        console.log("Order Name: " + orderName);
        console.log("Order Amount: " + orderAmount);

        // 이 후 IMP.request_pay 호출 등의 로직 추가
    });

    $('#payButton').click(function () {
        IMP.request_pay({
            pg: 'html5_inicis',
            pay_method: 'card',
            merchant_uid: 'merchant_' + new Date().getTime(),
            name: 라면,
            amount: 1000,
            buyer_email: 'your_email@example.com',
            buyer_name: 'your_buyer_name',
            buyer_tel: '010-1234-5678',
            buyer_addr: 'your_buyer_address',
            buyer_postcode: '123-456'
        }, function (rsp) {
            if (rsp.success) {
                $.post('/order/complete', function () {
                    window.location.href = '/orders';
                });
            } else {
                alert('Payment failed: ' + rsp.error_msg);
            }
        });
    });
</script>
</body>
</html>
